<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PSRTC IVR Simulator with Live Bus Tracking</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { 
  background:#f0f2f5; 
  font-family:'Segoe UI',sans-serif; 
  display:flex; 
  justify-content:center; 
  align-items:center; 
  min-height:100vh; 
  padding:15px;
}
.ivr-card { 
  background:#fff; 
  border-radius:20px; 
  box-shadow:0 8px 25px rgba(0,0,0,0.2); 
  max-width:800px; 
  width:100%; 
  padding:20px; 
  display:flex; 
  flex-direction:column; 
  margin-top:70px; /* Space for navbar */
}
.ivr-header{text-align:center;margin-bottom:15px;}
.ivr-header h3{margin-bottom:5px;}
.language-btns button{margin:3px;}
.ivr-display {
  background:#e9ecef; 
  height:300px; 
  border-radius:15px; 
  padding:15px; 
  overflow-y:auto; 
  margin-bottom:15px; 
  font-size:14px; 
  white-space:pre-line;
}
.menu-buttons { 
  display:flex; 
  flex-wrap:wrap; 
  gap:10px; 
  justify-content:center;
}
.menu-buttons button { 
  flex:1 1 40%; 
  min-width:120px; 
  padding:10px; 
  font-size:14px; 
  border-radius:12px; 
}
table{width:100%; font-size:13px; border-collapse: collapse;}
th, td{padding:4px 6px; text-align:left; border:1px solid #aaa;}
@media(max-width:500px){
  .ivr-card{padding:15px}
  .menu-buttons button{font-size:12px;min-width:100px} 
  table{font-size:12px}
}
</style>
</head>
<body>

<!-- ‚úÖ Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-danger fixed-top shadow">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold" href="index.html">
      <img src="unnamed-removebg-preview.png" alt="PSRTC Logo" width="150"  class="me-2">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link active" href="ivr.html">IVR</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Profile</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- IVR Card -->
<div class="ivr-card">
  <div class="ivr-header">
    <h3>üì± PSRTC IVR Simulator with Live Bus Tracking</h3>
    <p>Select Language / ‡§≠‡§æ‡§∑‡§æ / ‡®≠‡®æ‡®∏‡®º‡®æ</p>
    <div class="language-btns">
      <button class="btn btn-primary btn-sm" onclick="setLanguage('en')">English</button>
      <button class="btn btn-success btn-sm" onclick="setLanguage('hi')">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</button>
      <button class="btn btn-warning btn-sm" onclick="setLanguage('pa')">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä</button>
    </div>
  </div>

  <div class="ivr-display" id="ivrDisplay">Please select a language to start.</div>

  <div class="menu-buttons" id="menuButtons" style="display:none;">
    <button class="btn btn-info" onclick="selectOption(1)">Bus Timings</button>
    <button class="btn btn-info" onclick="selectOption(2)">Routes</button>
    <button class="btn btn-info" onclick="selectOption(3)">Live Bus Location</button>
    <button class="btn btn-danger" onclick="selectOption(0)">Exit</button>
    <button class="btn btn-warning" onclick="stopVoice()">Stop Voice</button>
  </div>
</div>

<script>
let selectedLang='en', voices=[], busInterval;
function initVoices(){voices=speechSynthesis.getVoices();if(voices.length===0)speechSynthesis.onvoiceschanged=()=>{voices=speechSynthesis.getVoices()}}
initVoices();

function speak(text){speechSynthesis.cancel(); let msg=new SpeechSynthesisUtterance(text); if(selectedLang==='en')msg.lang='en-IN'; else if(selectedLang==='hi')msg.lang='hi-IN'; else msg.lang='pa-IN'; speechSynthesis.speak(msg)}
function stopVoice(){speechSynthesis.cancel()}

// ‚úÖ More Bus Services with routes and stops
const busServices=[
  {number:"101",type:"Express",route:"Ludhiana ‚Üí Delhi",driver:"Mr. Singh",speed:0.0005,stops:[{name:"Ludhiana",lat:30.9,lng:75.85},{name:"Karnal",lat:29.7,lng:76.98},{name:"Delhi",lat:28.61,lng:77.21}]},
  {number:"102",type:"Local",route:"Chandigarh ‚Üí Amritsar",driver:"Mr. Sharma",speed:0.0006,stops:[{name:"Chandigarh",lat:30.74,lng:76.79},{name:"Jalandhar",lat:31.32,lng:75.58},{name:"Amritsar",lat:31.63,lng:74.87}]},
  {number:"103",type:"Superfast",route:"Patiala ‚Üí Delhi",driver:"Mr. Kapoor",speed:0.00055,stops:[{name:"Patiala",lat:30.34,lng:76.39},{name:"Ambala",lat:30.37,lng:76.77},{name:"Delhi",lat:28.61,lng:77.21}]},
  {number:"104",type:"Express",route:"Amritsar ‚Üí Chandigarh",driver:"Mr. Gill",speed:0.00065,stops:[{name:"Amritsar",lat:31.63,lng:74.87},{name:"Jalandhar",lat:31.32,lng:75.58},{name:"Chandigarh",lat:30.74,lng:76.79}]},
  {number:"105",type:"Local",route:"Bathinda ‚Üí Delhi",driver:"Mr. Mehta",speed:0.00052,stops:[{name:"Bathinda",lat:30.21,lng:74.95},{name:"Sirsa",lat:29.53,lng:75.03},{name:"Delhi",lat:28.61,lng:77.21}]},
  {number:"106",type:"Superfast",route:"Fazilka ‚Üí Patiala",driver:"Mr. Verma",speed:0.00053,stops:[{name:"Fazilka",lat:30.4,lng:74.6},{name:"Bathinda",lat:30.21,lng:74.95},{name:"Patiala",lat:30.34,lng:76.39}]},
  {number:"107",type:"Express",route:"Mohali ‚Üí Amritsar",driver:"Ms. Kaur",speed:0.00057,stops:[{name:"Mohali",lat:30.67,lng:76.73},{name:"Jalandhar",lat:31.32,lng:75.58},{name:"Amritsar",lat:31.63,lng:74.87}]},
  {number:"108",type:"Local",route:"Patiala ‚Üí Bathinda",driver:"Mr. Gill",speed:0.0005,stops:[{name:"Patiala",lat:30.34,lng:76.39},{name:"Barnala",lat:30.37,lng:75.53},{name:"Bathinda",lat:30.21,lng:74.95}]},
  {number:"109",type:"Superfast",route:"Chandigarh ‚Üí Patiala",driver:"Mr. Kapoor",speed:0.00055,stops:[{name:"Chandigarh",lat:30.74,lng:76.79},{name:"Mohali",lat:30.67,lng:76.73},{name:"Patiala",lat:30.34,lng:76.39}]},
  {number:"110",type:"Express",route:"Amritsar ‚Üí Delhi",driver:"Mr. Sharma",speed:0.0006,stops:[{name:"Amritsar",lat:31.63,lng:74.87},{name:"Ludhiana",lat:30.9,lng:75.85},{name:"Delhi",lat:28.61,lng:77.21}]},
  {number:"111",type:"Local",route:"Ludhiana ‚Üí Chandigarh",driver:"Mr. Verma",speed:0.0005,stops:[{name:"Ludhiana",lat:30.9,lng:75.85},{name:"Mohali",lat:30.67,lng:76.73},{name:"Chandigarh",lat:30.74,lng:76.79}]},
  {number:"112",type:"Superfast",route:"Ferozepur ‚Üí Delhi",driver:"Mr. Bedi",speed:0.00055,stops:[{name:"Ferozepur",lat:30.93,lng:74.62},{name:"Ludhiana",lat:30.9,lng:75.85},{name:"Delhi",lat:28.61,lng:77.21}]}
];

// Initialize positions
busServices.forEach(bus=>{bus.currentStop=0; bus.lat=bus.stops[0].lat; bus.lng=bus.stops[0].lng})

function setLanguage(lang){
  selectedLang=lang; 
  const texts={
    en:"Welcome passengers!\nPlease select an option below.",
    hi:"‡§∏‡§≠‡•Ä ‡§Ø‡§æ‡§§‡•ç‡§∞‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à!\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§",
    pa:"‡®∏‡®æ‡®∞‡©á ‡®Ø‡®æ‡®§‡®∞‡©Ä‡®Ü‡®Ç ‡®¶‡®æ ‡®∏‡®µ‡®æ‡®ó‡®§ ‡®π‡©à!\n‡®ï‡®ø‡®∞‡®™‡®æ ‡®ï‡®∞‡®ï‡©á ‡®µ‡®ø‡®ï‡®≤‡®™ ‡®ö‡©Å‡®£‡©ã"
  }; 
  document.getElementById('ivrDisplay').innerText=texts[lang]; 
  speak(texts[lang]); 
  document.getElementById('menuButtons').style.display='flex'
}

function selectOption(option){
  stopVoice(); clearInterval(busInterval);
  const display=document.getElementById('ivrDisplay');
  if(option===0){
    const texts={
      en:"Thank you for using PSRTC IVR.\nHappy Journey!",
      hi:"PSRTC IVR ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶‡•§\n‡§∏‡•Å‡§ñ‡§¶ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ!",
      pa:"PSRTC IVR ‡®µ‡®∞‡®§‡®£ ‡®≤‡®à ‡®ß‡©∞‡®®‡®µ‡®æ‡®¶‡•§\n‡®∏‡®´‡®º‡®≤ ‡®Ø‡®æ‡®§‡®∞‡®æ!"
    }; 
    display.innerText=texts[selectedLang]; 
    speak(texts[selectedLang]); 
    document.getElementById('menuButtons').style.display='none'; 
    return
  }
  if(option===1){showBusTimings()}
  else if(option===2){display.innerText="Routes:\n"+busServices.map(b=>b.route).join("\n"); speak("Showing all routes.")}
  else if(option===3){updateBusLocations(); speak("Displaying live bus locations."); busInterval=setInterval(updateBusLocations,2000)}
}

function showBusTimings(){
  const display=document.getElementById('ivrDisplay'); display.innerHTML='';
  let table=document.createElement('table'); let header=table.insertRow();
  ["Bus No","Type","Route","Driver","First Bus","Last Bus","Frequency"].forEach(h=>{let th=document.createElement('th'); th.innerText=h; header.appendChild(th)});
  busServices.forEach(bus=>{
    let row=table.insertRow(); 
    [bus.number,bus.type,bus.route,bus.driver,"5:00 AM","11:00 PM","15 mins"].forEach(v=>{
      let cell=row.insertCell(); cell.innerText=v
    }); 
    speak(`${bus.type} bus ${bus.number} on route ${bus.route}`)
  }); 
  display.appendChild(table)
}

function updateBusLocations(){
  const display=document.getElementById('ivrDisplay'); let html="Live Bus Locations with ETA:\n";
  busServices.forEach(bus=>{
    const nextStopIndex=(bus.currentStop+1)%bus.stops.length;
    const nextStop=bus.stops[nextStopIndex];
    let distanceLat=nextStop.lat-bus.lat; 
    let distanceLng=nextStop.lng-bus.lng;
    let distance=Math.sqrt(distanceLat*distanceLat+distanceLng*distanceLng);
    let eta=Math.round(distance/bus.speed*0.02); 
    html+=`${bus.number} (${bus.type}) at (${bus.lat.toFixed(4)},${bus.lng.toFixed(4)}) ‚Üí Next stop: ${nextStop.name}, ETA: ${eta} min\n`;
    bus.lat+=distanceLat*bus.speed; 
    bus.lng+=distanceLng*bus.speed;
    if(Math.abs(bus.lat-nextStop.lat)<0.001 && Math.abs(bus.lng-nextStop.lng)<0.001){bus.currentStop=nextStopIndex}
  });
  display.innerText=html;
}
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
